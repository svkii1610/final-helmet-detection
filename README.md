# Safety Helmet Detection (Faster R-CNN, PyTorch)

р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╣Бр╕ер╕░р╣Вр╕Др╣Йр╕Фр╕Ыр╕гр╕░р╕Бр╕нр╕Ър╣Вр╕Др╕гр╕Зр╕Зр╕▓р╕Щр╕зр╕┤р╕Кр╕▓ 01204466  
**тАЬр╕гр╕░р╕Ър╕Ър╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╕лр╕бр╕зр╕Бр╕Щр╕┤р╕гр╕ар╕▒р╕вр╣Гр╕Щр╣Ар╕Вр╕Хр╕Бр╣Ир╕нр╕кр╕гр╣Йр╕▓р╕Зр╕Фр╣Йр╕зр╕в Deep LearningтАЭ**

- ЁЯУШ р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Йр╕Ър╕▒р╕Ър╣Ар╕Хр╣Зр╕б: `helmet_detect_final_report.pdf`
- ЁЯУУ р╣Вр╕Др╣Йр╕Фр╕Чр╕Фр╕ер╕нр╕З/р╕Эр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕е: `helmet_detection_project.ipynb`

---

## ЁЯОп р╣Вр╕Ир╕Чр╕вр╣Мр╣Бр╕ер╕░р╣Бр╕гр╕Зр╕Ир╕╣р╕Зр╣Гр╕И

р╣Гр╕Щр╣Др╕Лр╕Хр╣Мр╕Бр╣Ир╕нр╕кр╕гр╣Йр╕▓р╕З р╕Бр╕▓р╕гр╕кр╕зр╕б **р╕лр╕бр╕зр╕Бр╕Щр╕┤р╕гр╕ар╕▒р╕в** р╣Ар╕Ыр╣Зр╕Щр╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Фр╕кр╕│р╕Др╕▒р╕Нр╣Ар╕Юр╕╖р╣Ир╕нр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕нр╕╕р╕Ър╕▒р╕Хр╕┤р╣Ар╕лр╕Хр╕╕  
р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕Фр╣Йр╕зр╕вр╕бр╕Щр╕╕р╕йр╕вр╣Мр╕бр╕╡р╕Вр╣Йр╕нр╕Ир╕│р╕Бр╕▒р╕Ф (р╕Хр╕гр╕зр╕Ир╣Др╕бр╣Ир╕Др╕гр╕Ъ, р╣Ар╕лр╕Щр╕╖р╣Ир╕нр╕вр╕ер╣Йр╕▓, р╣Др╕бр╣Ир╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕З) р╕Ир╕╢р╕Зр╕Юр╕▒р╕Тр╕Щр╕▓ **р╕гр╕░р╕Ър╕Ър╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤** р╕Ир╕▓р╕Бр╕ар╕▓р╕Ю/р╕зр╕┤р╕Фр╕╡р╣Вр╕нр╕Фр╣Йр╕зр╕вр╣Ар╕Чр╕Др╕Щр╕┤р╕Д **Deep Learning** р╣Ар╕Юр╕╖р╣Ир╕нр╕Кр╣Ир╕зр╕вр╣Ар╕Эр╣Йр╕▓р╕гр╕░р╕зр╕▒р╕Зр╣Бр╕ер╕░р╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щ

---

## ЁЯза р╕кр╕гр╕╕р╕Ыр╣Бр╕Щр╕зр╕Чр╕▓р╕З (Overview)

- р╕Зр╕▓р╕Щ: **Object Detection** (р╕гр╕░р╕Ър╕╕р╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕З + р╕Ир╕│р╣Бр╕Щр╕Бр╕Ыр╕гр╕░р╣Ар╕ар╕Ч)
- р╣Вр╕бр╣Ар╕Фр╕е: **Faster R-CNN (ResNet-50 + FPN)**  
  р╕Ыр╕гр╕▒р╕Ъ **ROI Head р╣Бр╕Ър╕Ъ Custom MLP**: `Linear тЖТ LayerNorm тЖТ SiLU тЖТ Dropout тЖТ Linear тЖТ SiLU`  
  р╣Бр╕вр╕Бр╕лр╕▒р╕з `Classifier` р╣Бр╕ер╕░ `BBox Regressor`
- Train details: **AdamW**, `lr=7e-4`, `weight_decay=1e-2`, **AMP (mixed precision)**  
  р╕ер╕Ф proposal/roi sampling р╕Ър╕▓р╕Зр╕кр╣Ир╕зр╕Щр╣Ар╕Юр╕╖р╣Ир╕нр╕Др╕зр╕▓р╕бр╣Ар╕гр╣Зр╕з
- р╕Вр╕Щр╕▓р╕Фр╕ар╕▓р╕Ю: `640├Ч640`
- р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З (р╕Кр╕╕р╕Фр╕Чр╕Фр╕кр╕нр╕Ъ): **Precision тЙИ 0.916**, **Recall тЙИ 0.828**

> р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Ар╕Кр╕┤р╕Зр╕Чр╕др╕йр╕Ор╕╡ + р╕нр╕Шр╕┤р╕Ър╕▓р╕вр╕ар╕▓р╕Юр╕кр╕Цр╕▓р╕Ыр╕▒р╕Хр╕вр╕Бр╕гр╕гр╕б р╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕лр╕▒р╕зр╕Вр╣Йр╕н 4 р╕Вр╕нр╕З `helmet_detect_final_report.pdf`

---

## ЁЯЧВя╕П р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Гр╕Щ Repo

.
тФЬтФАтФА README.md # р╣Др╕Яр╕ер╣Мр╕Щр╕╡р╣Й
тФЬтФАтФА helmet_detection_project.ipynb # Notebook р╕Эр╕╢р╕Б/р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щ/р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Ьр╕е
тФФтФАтФА helmet_detect_final_report.pdf # р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Йр╕Ър╕▒р╕Ър╕кр╣Ир╕З


---

## ЁЯУЪ р╕Кр╕╕р╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е (Dataset)

- р╕Кр╕╖р╣Ир╕н: **Construction Site Safety Image Dataset (Roboflow)**
- р╣Бр╕лр╕ер╣Ир╕Зр╕Чр╕╡р╣Ир╕бр╕▓ (Kaggle): https://www.kaggle.com/datasets/snehilsanyal/construction-site-safety-image-dataset-roboflow
- р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ъ: **Pascal VOC (.xml)**  
- р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Бр╕Щр╕░р╕Щр╕│

Dataset/
тФЬтФАтФА train/{images, annotations}
тФЬтФАтФА val/{images, annotations}
тФФтФАтФА test/{images, annotations}
- р╕Др╕ер╕▓р╕кр╕Чр╕╡р╣Ир╣Гр╕Кр╣Й (р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З): `Helmet`, `No-Helmet/Head`, `Person`  
*(р╣Гр╕лр╣Йр╣Бр╕Бр╣Йр╣Гр╕лр╣Йр╕Хр╕гр╕Зр╕Бр╕▒р╕Ъ annotation р╕Чр╕╡р╣Ир╕Др╕╕р╕Ур╣Гр╕Кр╣Йр╕Ир╕гр╕┤р╕З)*

---

## тЪЩя╕П р╕кр╕┤р╣Ир╕Зр╣Бр╕зр╕Фр╕ер╣Йр╕нр╕бр╣Бр╕ер╕░р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З (Environment)

- Python 3.10+
- PyTorch + torchvision (р╕гр╕нр╕Зр╕гр╕▒р╕Ъ CUDA р╕Цр╣Йр╕▓р╕бр╕╡ GPU)
- р╣Др╕ер╕Ър╕гр╕▓р╕гр╕╡р╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ: `numpy, matplotlib, tqdm, opencv-python`

> **р╣Бр╕Щр╕░р╕Щр╕│:** р╕гр╕▒р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Ьр╣Ир╕▓р╕Щ Google Colab р╣Др╕Фр╣Йр╕Чр╕▒р╕Щр╕Чр╕╡ (р╕Хр╕▒р╣Йр╕З path р╕Вр╕нр╕З Dataset р╣Гр╕лр╣Йр╕Цр╕╣р╕Бр╕Бр╣Ир╕нр╕Щ Run All)

---

## ЁЯЪА р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ Notebook

1. р╣Ар╕Ыр╕┤р╕Ф `helmet_detection_project.ipynb`
2. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Юр╕▓р╕Шр╣Др╕Ыр╕вр╕▒р╕З Dataset (`train/`, `val/`, `test/`)
3. Run р╕Хр╕▓р╕бр╕ер╕│р╕Фр╕▒р╕Ър╣Ар╕Лр╕ер╕ер╣М:
 - р╣Вр╕лр╕ер╕Фр╣Бр╕ер╕░р╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Вр╣Йр╕нр╕бр╕╣р╕е (Dataset + Dataloader + collate_fn)
 - р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕бр╣Ар╕Фр╕е (Faster R-CNN + Custom ROI Head)
 - р╕Эр╕╢р╕Бр╕кр╕нр╕Щ (AdamW + AMP, ~12 epochs)
 - р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Ьр╕е (Precision / Recall / F1 / AP@0.5) р╣Бр╕ер╕░р╕зр╕▓р╕Фр╕Бр╕гр╕▓р╕Я Loss
 - р╣Бр╕кр╕Фр╕Зр╕ар╕▓р╕Юр╕Ьр╕ер╕Бр╕▓р╕гр╕Чр╕│р╕Щр╕▓р╕в (р╕Бр╕ер╣Ир╕нр╕З + label + score)

---

## ЁЯУИ р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Ьр╕е (Evaluation)

- Metrics: **Precision**, **Recall**, **F1-Score**, **mAP (VOC @IoU 0.5)**  
- р╕Др╣Ир╕▓ threshold р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╕Чр╕╡р╣И `0.5` (р╕Ыр╕гр╕▒р╕Ър╣Др╕Фр╣Йр╕Хр╕▓р╕бр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕Зр╕▓р╕Щ: р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕ер╕Ф false alarm р╕лр╕гр╕╖р╕нр╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕Ир╕▒р╕Ър╣Гр╕лр╣Йр╕Др╕гр╕Ъ)
- р╕Ьр╕ер╕кр╕гр╕╕р╕Ыр╕Чр╕╡р╣Ир╕гр╕▓р╕вр╕Зр╕▓р╕Щ: **Precision тЙИ 0.916**, **Recall тЙИ 0.828**  
*(р╣Гр╕лр╣Йр╣Гр╕кр╣Ир╕Др╣Ир╕▓р╕Ир╕гр╕┤р╕Зр╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕гр╕▒р╕Щр╕Др╕гр╕▒р╣Йр╕Зр╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕вр╕Вр╕нр╕Зр╕Др╕╕р╕Ур╕лр╕▓р╕Бр╕Хр╣Ир╕▓р╕Зр╕Ир╕▓р╕Бр╕Щр╕╡р╣Й)*

---

## ЁЯзй р╕Ир╕╕р╕Фр╣Ар╕Фр╣Ир╕Щр╣Ар╕Кр╕┤р╕Зр╣Ар╕Чр╕Др╕Щр╕┤р╕Д

- **Custom ROI Head** (р╣Бр╕Чр╕Щ FastRCNNPredictor р╕бр╕▓р╕Хр╕гр╕Рр╕▓р╕Щ) р╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕кр╕Цр╕╡р╕вр╕гр╕ар╕▓р╕Юр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Щр╕гр╕╣р╣Йр╣Бр╕ер╕░р╕ер╕Ф overfitting р╣Ар╕бр╕╖р╣Ир╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕│р╕Бр╕▒р╕Ф
- **AMP (Mixed Precision)** р╕Кр╣Ир╕зр╕вр╣Ар╕гр╣Ир╕Зр╕Др╕зр╕▓р╕бр╣Ар╕гр╣Зр╕з/р╕ер╕Фр╕лр╕Щр╣Ир╕зр╕вр╕Др╕зр╕▓р╕бр╕Ир╕│р╕Ър╕Щ GPU
- **Tuning р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕зр╕▓р╕бр╣Ар╕гр╣Зр╕з**: р╕ер╕Фр╕Ир╕│р╕Щр╕зр╕Щ proposals р╣Бр╕ер╕░ `roi_heads.batch_size_per_image` тЖТ р╣Ар╕Чр╕гр╕Щр╣Бр╕ер╕░р╕Чр╕│р╕Щр╕▓р╕вр╣Ар╕гр╣Зр╕зр╕Вр╕╢р╣Йр╕Щр╣Вр╕Фр╕вр╣Бр╕Чр╕Ър╣Др╕бр╣Ир╣Ар╕кр╕╡р╕вр╕Др╕зр╕▓р╕бр╣Бр╕бр╣Ир╕Щр╕вр╕│

---

## ЁЯЦ╝я╕П р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М

р╕Фр╕╣р╕ар╕▓р╕Юр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Юр╕гр╣Йр╕нр╕бр╕Бр╕гр╕нр╕Ър╕Чр╕│р╕Щр╕▓р╕вр╣Бр╕ер╕░р╕Бр╕гр╕▓р╕Я Loss р╣Гр╕Щ:
- Section 7.4 р╕Вр╕нр╕З `helmet_detect_final_report.pdf`
- р╕кр╣Ир╕зр╕Щ Visualization р╕Хр╕нр╕Щр╕Чр╣Йр╕▓р╕вр╕Вр╕нр╕З `helmet_detection_project.ipynb`

---

## ЁЯФЧ р╣Ар╕нр╕Бр╕кр╕▓р╕гр╕нр╣Йр╕▓р╕Зр╕нр╕┤р╕Зр╣Бр╕ер╕░р╕Зр╕▓р╕Щр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕З (Selected)

- Faster R-CNN: Ren et al., 2015  
- FPN: Lin et al., 2017  
- р╕Зр╕▓р╕Щр╕Фр╣Йр╕▓р╕Щр╕лр╕бр╕зр╕Бр╕Щр╕┤р╕гр╕ар╕▒р╕вр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕З: р╕Зр╕▓р╕Щ YOLOv5 (real-time) р╣Бр╕ер╕░р╕Зр╕▓р╕Щ Faster R-CNN (р╕Др╕зр╕▓р╕бр╣Бр╕бр╣Ир╕Щр╕вр╕│р╕кр╕╣р╕Зр╣Гр╕Щр╕Йр╕▓р╕Бр╕Лр╕▒р╕Ър╕Лр╣Йр╕нр╕Щ) тАФ р╕кр╕гр╕╕р╕Ыр╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕Ър╕Чр╕Чр╕╡р╣И 8 р╕Вр╕нр╕Зр╕гр╕▓р╕вр╕Зр╕▓р╕Щ

---

## ЁЯСе р╕Ьр╕╣р╣Йр╕Ир╕▒р╕Фр╕Чр╕│ (Team)

- р╕Щр╕▓р╕Зр╕кр╕▓р╕зр╕Ър╕╕р╕Ур╕вр╕▓р╕Юр╕г р╕Ър╕╕р╕Нр╕Чр╕▒р╕Ъ тАФ р╕нр╕нр╕Бр╣Бр╕Ър╕Ъ/р╕Юр╕▒р╕Тр╕Щр╕▓р╣Вр╕бр╣Ар╕Фр╕е, р╣Ар╕Чр╕гр╕Щ & Evaluate, р╣Ар╕Вр╕╡р╕вр╕Щр╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕кр╣Ир╕зр╕Щ Model/Training/Eval
- р╕Щр╕▓р╕Зр╕кр╕▓р╕зр╣Др╕Вр╣Ир╕бр╕╕р╕Бр╕Вр╣М р╕Шр╕▓р╕Щр╕░р╕Бр╕┤р╕И тАФ р╣Ар╕Хр╕гр╕╡р╕вр╕бр╣Бр╕ер╕░р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕е, Implementation, р╕кр╕гр╕╕р╕Ыр╕Ьр╕ер╕Бр╕▓р╕гр╕Чр╕Фр╕ер╕нр╕З & р╕Ир╕▒р╕Фр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕гр╕▓р╕вр╕Зр╕▓р╕Щ

р╕нр╕▓р╕Ир╕▓р╕гр╕вр╣Мр╕Ьр╕╣р╣Йр╕кр╕нр╕Щ: **р╕нр╕▓р╕Ир╕▓р╕гр╕вр╣М р╕ар╕▓р╕гр╕╕р╕И р╕гр╕▒р╕Хр╕Щр╕зр╕гр╕Юр╕▒р╕Щр╕Шр╕╕р╣М**  
р╕Др╕Ур╕░р╕зр╕┤р╕ир╕зр╕Бр╕гр╕гр╕бр╕ир╕▓р╕кр╕Хр╕гр╣М р╕кр╕▓р╕Вр╕▓р╕зр╕┤р╕ир╕зр╕Бр╕гр╕гр╕бр╕Др╕нр╕бр╕Юр╕┤р╕зр╣Ар╕Хр╕нр╕гр╣М р╕бр╕лр╕▓р╕зр╕┤р╕Чр╕вр╕▓р╕ер╕▒р╕вр╣Ар╕Бр╕йр╕Хр╕гр╕ир╕▓р╕кр╕Хр╕гр╣М

---

## ЁЯУЬ License

р╣Ар╕Юр╕╖р╣Ир╕нр╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓/р╕зр╕┤р╕Ир╕▒р╕вр╕ар╕▓р╕вр╣Гр╕Щр╕гр╕▓р╕вр╕зр╕┤р╕Кр╕▓р╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ  
> р╕лр╕▓р╕Бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Ар╕Ьр╕вр╣Бр╕Юр╕гр╣Ир╕кр╕▓р╕Шр╕▓р╕гр╕Ур╕░ р╣Вр╕Ыр╕гр╕Фр╣Ар╕Юр╕┤р╣Ир╕бр╣Др╕Яр╕ер╣М `LICENSE` р╣Гр╕лр╣Йр╕Кр╕▒р╕Фр╣Ар╕Ир╕Щ (р╣Ар╕Кр╣Ир╕Щ MIT/Apache-2.0) р╣Бр╕ер╕░р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Вр╕нр╕З Dataset р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

---
